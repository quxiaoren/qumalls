import{_ as s,o as a,c as n,V as l}from"./chunks/framework.4490fb98.js";const h=JSON.parse('{"title":"私有 Storage 数据","description":"","frontmatter":{},"headers":[],"relativePath":"guide/storage.md","filePath":"guide/storage.md"}'),o={name:"guide/storage.md"},e=l(`<h1 id="私有-storage-数据" tabindex="-1">私有 Storage 数据 <sup class="pro-badge"></sup> <a class="header-anchor" href="#私有-storage-数据" aria-label="Permalink to &quot;私有 Storage 数据 &lt;sup class=&quot;pro-badge&quot; /&gt;&quot;">​</a></h1><p>由于 localStorage 和 sessionStorage 的同源策略，同一域名下的 storage 数据会共享。如果你恰好需要在同一域名下部署两套(及以上)系统，不可避免会出现 storage 数据冲突，框架提供了一个 storage 类来解决这个问题。</p><p>解决同源 storage 数据冲突的方式就是增加前缀区分，首先需要在应用配置中设置一个唯一且不重名的前缀：</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark has-highlighted-lines vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">globalSettings</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Settings</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">all</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line highlighted"><span style="color:#E1E4E8;">  app: {</span></span>
<span class="line highlighted"><span style="color:#E1E4E8;">    storagePrefix: </span><span style="color:#9ECBFF;">&#39;fa_&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line highlighted"><span style="color:#E1E4E8;">  },</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light has-highlighted-lines vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">globalSettings</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Settings</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">all</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> {</span></span>
<span class="line highlighted"><span style="color:#24292E;">  app: {</span></span>
<span class="line highlighted"><span style="color:#24292E;">    storagePrefix: </span><span style="color:#032F62;">&#39;fa_&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line highlighted"><span style="color:#24292E;">  },</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>然后在需要使用到 storage 的地方引入：</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> storage </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;@/utils/storage&#39;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> storage </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;@/utils/storage&#39;</span></span></code></pre></div><p>这个类封装了 <code>setItem()</code> ，<code>getItem()</code> ，<code>removeItem()</code> ，<code>clear()</code> 方法，同时还增加了一个 <code>has()</code> 方法用来判断对象是否存在：</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">// localStorage</span></span>
<span class="line"><span style="color:#E1E4E8;">storage.local.</span><span style="color:#B392F0;">has</span><span style="color:#E1E4E8;">(key)</span></span>
<span class="line"><span style="color:#E1E4E8;">storage.local.</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(key)</span></span>
<span class="line"><span style="color:#E1E4E8;">storage.local.</span><span style="color:#B392F0;">set</span><span style="color:#E1E4E8;">(key, value)</span></span>
<span class="line"><span style="color:#E1E4E8;">storage.local.</span><span style="color:#B392F0;">remove</span><span style="color:#E1E4E8;">(key)</span></span>
<span class="line"><span style="color:#E1E4E8;">storage.local.</span><span style="color:#B392F0;">clear</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// sessionStorage</span></span>
<span class="line"><span style="color:#E1E4E8;">storage.session.</span><span style="color:#B392F0;">has</span><span style="color:#E1E4E8;">(key)</span></span>
<span class="line"><span style="color:#E1E4E8;">storage.session.</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(key)</span></span>
<span class="line"><span style="color:#E1E4E8;">storage.session.</span><span style="color:#B392F0;">set</span><span style="color:#E1E4E8;">(key, value)</span></span>
<span class="line"><span style="color:#E1E4E8;">storage.session.</span><span style="color:#B392F0;">remove</span><span style="color:#E1E4E8;">(key)</span></span>
<span class="line"><span style="color:#E1E4E8;">storage.session.</span><span style="color:#B392F0;">clear</span><span style="color:#E1E4E8;">()</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// localStorage</span></span>
<span class="line"><span style="color:#24292E;">storage.local.</span><span style="color:#6F42C1;">has</span><span style="color:#24292E;">(key)</span></span>
<span class="line"><span style="color:#24292E;">storage.local.</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">(key)</span></span>
<span class="line"><span style="color:#24292E;">storage.local.</span><span style="color:#6F42C1;">set</span><span style="color:#24292E;">(key, value)</span></span>
<span class="line"><span style="color:#24292E;">storage.local.</span><span style="color:#6F42C1;">remove</span><span style="color:#24292E;">(key)</span></span>
<span class="line"><span style="color:#24292E;">storage.local.</span><span style="color:#6F42C1;">clear</span><span style="color:#24292E;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// sessionStorage</span></span>
<span class="line"><span style="color:#24292E;">storage.session.</span><span style="color:#6F42C1;">has</span><span style="color:#24292E;">(key)</span></span>
<span class="line"><span style="color:#24292E;">storage.session.</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">(key)</span></span>
<span class="line"><span style="color:#24292E;">storage.session.</span><span style="color:#6F42C1;">set</span><span style="color:#24292E;">(key, value)</span></span>
<span class="line"><span style="color:#24292E;">storage.session.</span><span style="color:#6F42C1;">remove</span><span style="color:#24292E;">(key)</span></span>
<span class="line"><span style="color:#24292E;">storage.session.</span><span style="color:#6F42C1;">clear</span><span style="color:#24292E;">()</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">注意</p><p>由于 localStorage 有容量上限，一般为 5M ，如果一同域名下部署两套系统，意味着两套系统共享 5M 容量，所以不建议在同一域名部署太多套系统，避免出现 localStorage 不够用的情况。</p></div>`,9),p=[e];function t(c,r,i,E,y,g){return a(),n("div",null,p)}const u=s(o,[["render",t]]);export{h as __pageData,u as default};
